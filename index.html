<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Prim Hesaplama</title>
<style>
:root{
  --primary:#1976d2;
  --bg:#f4f4f4;
  --card:#ffffff;
}
html,body{height:100%;margin:0;font-family:sans-serif;background:var(--bg);color:#333;}
body{display:flex;justify-content:center;padding:16px;align-items:flex-start;}
.wrap{
  width:100%;
  max-width:480px;
  background:var(--card);
  border-radius:10px;
  box-shadow:0 4px 12px rgba(0,0,0,0.08);
  padding:20px;
  display:flex;
  flex-direction:column;
  gap:16px;
}
label{display:block;margin-top:12px;font-weight:600;font-size:14px;}
select,input[type="number"],input[type="text"],input[type="password"]{
  width:100%;
  padding:10px;
  margin-top:6px;
  border-radius:6px;
  border:1px solid #ccc;
  font-size:14px;
  box-sizing:border-box;
}
.kredi-row{display:flex;align-items:center;gap:10px;margin-top:10px;}
.kredi-row input[type="checkbox"]{width:18px;height:18px;}
.actions{display:flex;gap:10px;margin-top:16px;}
button{
  flex:1;
  padding:12px;
  border-radius:8px;
  border:none;
  cursor:pointer;
  font-weight:700;
  color:white;
  font-size:14px;
}
.btn-calc{background:var(--primary);}
.btn-clear{background:#ccc;color:#333;}
.result{
  background:#fff;
  border-radius:8px;
  padding:16px;
  border:1px solid #ddd;
}
.result h3{margin:0 0 8px 0;font-size:16px;}
.line{display:flex;justify-content:space-between;margin:6px 0;font-size:14px;}
.muted{color:#666;font-weight:600;}
.big{font-size:18px;font-weight:800;}
.by{text-align:right;color:#999;font-weight:600;font-size:12px;margin-top:6px;}
.hidden{display:none;}
</style>
</head>
<body>

<!-- Giriş Ekranı -->
<div class="wrap" id="loginWrap">
  <h1>Giriş Yap</h1>
  <label for="userId">Kullanıcı Adı</label>
  <input type="text" id="userId" placeholder="Kullanıcı adı">
  <label for="userPass">Şifre</label>
  <input type="password" id="userPass" placeholder="Şifre">
  <div class="actions">
    <button id="btnLogin" class="btn-calc">GİRİŞ</button>
  </div>
</div>

<!-- Prim Hesaplama Ekranı -->
<div class="wrap hidden" id="primWrap">

  <h1>Prim Hesaplama</h1>

  <label for="urun">ÜRÜN SEÇİN</label>
  <select id="urun"></select>

  <label for="satis">SATIŞ ŞEKLİ SEÇİN</label>
  <select id="satis"></select>

  <div class="kredi-row">
    <input type="checkbox" id="checkKredi">
    <label for="checkKredi">Kredi Kartı Seçeneği</label>
    <select id="krediOpt" disabled style="flex:1;"></select>
  </div>

  <label for="toplam">TOPLAM SATIŞ TUTARI (₺)</label>
  <input id="toplam" type="number" step="0.01" disabled>

  <label for="nakit">NAKİT TUTARI (₺)</label>
  <input id="nakit" type="number" step="0.01" placeholder="Nakit tutarını girin">

  <label for="senet">SENET TUTARI (₺) — otomatik</label>
  <input id="senet" type="number" step="0.01" disabled>

  <label for="hesaba">HESABA DÜŞEN (₺) — (kredi kartı için)</label>
  <input id="hesaba" type="number" step="0.01" placeholder="Kredi kartı için" disabled>

  <div class="actions">
    <button id="btnHesapla" class="btn-calc">HESAPLA</button>
    <button id="btnTemizle" class="btn-clear">TEMİZLE</button>
  </div>

  <div class="result">
    <h3>Hesap Sonuçları</h3>
    <div class="line"><div class="muted">Toplam Satış</div><div id="rToplam" class="muted">₺0,00</div></div>
    <div class="line"><div class="muted">Nakit (KDV'li)</div><div id="rNakitKdv">₺0,00</div></div>
    <div class="line"><div class="muted">Senet (KDV'li)</div><div id="rSenetKdv">₺0,00</div></div>
    <div class="line"><div class="muted">Nakit Prim</div><div id="rNakitPrim">₺0,00</div></div>
    <div class="line"><div class="muted">Senet Prim</div><div id="rSenetPrim">₺0,00</div></div>
    <div class="line"><div class="muted">Kredi Kartı Primi</div><div id="rKrediPrim">₺0,00</div></div>
    <div class="line"><div class="muted">Toplam Prim</div><div id="rTopPrim" class="big">₺0,00</div></div>
  </div>

  <div class="by">by_Oğuz</div>
</div>

<script>
// --- Giriş Kontrol ---
const loginWrap = document.getElementById('loginWrap');
const primWrap = document.getElementById('primWrap');
const btnLogin = document.getElementById('btnLogin');
btnLogin.addEventListener('click',()=>{
  const id = document.getElementById('userId').value.trim();
  const pass = document.getElementById('userPass').value.trim();
  if(id==='ihlas' && pass==='1234'){
    loginWrap.classList.add('hidden');
    primWrap.classList.remove('hidden');
  } else {
    alert('Kullanıcı adı veya şifre yanlış!');
  }
});

// --- Orijinal JS Kodu ---
const satisMap = {
  "TR":{"1+1":63000,"1+5":70000,"1+8":75000,"1+12":80000,"1+15":84000,"1+18":90000,"1+21":96000,"1+24":102000,"K.KARTI TEK ÇEKİM":60000,"K.KARTI 2 TAKSİT":63000,"K.KARTI 5 TAKSİT":65000,"K.KARTI 9 TAKSİT":70000},
  "RO - Unique":{"1+1":24000,"1+4":26000,"1+7":28000,"1+12":30000,"1+15":32000,"1+18":34000,"1+21":35000,"K.KARTI TEK ÇEKİM":23000,"K.KARTI 2 TAKSİT":24000,"K.KARTI 5 TAKSİT":25000,"K.KARTI 9 TAKSİT":28000},
  "RO - Unique M5":{"1+1":24500,"1+4":27000,"1+7":29000,"1+12":31000,"1+15":33000,"1+18":35000,"1+21":36000,"K.KARTI TEK ÇEKİM":23500,"K.KARTI 2 TAKSİT":24500,"K.KARTI 5 TAKSİT":26000,"K.KARTI 9 TAKSİT":29000},
  "RO - Platinum":{"1+1":15000,"1+4":17000,"1+7":18000,"1+12":20000,"1+15":21000,"K.KARTI TEK ÇEKİM":15000,"K.KARTI 2 TAKSİT":15500,"K.KARTI 9 TAKSİT":18500},
  "RO - Silver":{"1+1":6200,"1+4":6700,"1+7":7200,"1+12":7700,"1+15":8200,"K.KARTI TEK ÇEKİM":5900,"K.KARTI 2 TAKSİT":6200,"K.KARTI 9 TAKSİT":7000},
  "Klima-12":{"1+4":31000,"1+9":36000,"1+12":37500,"K.KARTI TEK ÇEKİM":27900,"K.KARTI 9 TAKSİT":31000},
  "Klima-18":{"1+4":43500,"1+9":50500,"1+12":55000,"K.KARTI TEK ÇEKİM":38500,"K.KARTI 9 TAKSİT":43500}
};

const urunEl=document.getElementById('urun'),
      satisEl=document.getElementById('satis'),
      toplamEl=document.getElementById('toplam'),
      nakitEl=document.getElementById('nakit'),
      senetEl=document.getElementById('senet'),
      checkKredi=document.getElementById('checkKredi'),
      krediOpt=document.getElementById('krediOpt'),
      hesabaEl=document.getElementById('hesaba');

const rToplam=document.getElementById('rToplam'),
      rNakitKdv=document.getElementById('rNakitKdv'),
      rSenetKdv=document.getElementById('rSenetKdv'),
      rNakitPrim=document.getElementById('rNakitPrim'),
      rSenetPrim=document.getElementById('rSenetPrim'),
      rKrediPrim=document.getElementById('rKrediPrim'),
      rTopPrim=document.getElementById('rTopPrim');

const btnHesapla=document.getElementById('btnHesapla'),
      btnTemizle=document.getElementById('btnTemizle');

function tl(v){return '₺'+Number(v||0).toLocaleString('tr-TR',{minimumFractionDigits:2,maximumFractionDigits:2})}

function populateUrunler(){
  urunEl.innerHTML='';
  for(const u of Object.keys(satisMap)){
    const opt=document.createElement('option');
    opt.value=u;
    opt.textContent=u;
    urunEl.appendChild(opt);
  }
}

function updateSatisOptions(){
  const u = urunEl.value;
  satisEl.innerHTML='';
  if(!satisMap[u]) return;
  const keys=Object.keys(satisMap[u]).filter(k=>!k.includes('K.KARTI'));
  keys.forEach(k=>{
    const opt=document.createElement('option');
    opt.value=k;
    opt.textContent=k;
    satisEl.appendChild(opt);
  });
  satisEl.selectedIndex=0;
  toplamEl.value = keys[0] ? satisMap[u][keys[0]] : 0;
  updateSenet();
  renderResultsReset();
}

function updateKrediOptions(){
  const u = urunEl.value;
  krediOpt.innerHTML='';
  const krediKeys = Object.keys(satisMap[u]||{}).filter(k=>k.includes('K.KARTI'));
  if(krediKeys.length===0){
    kreditFallbacks().forEach(k=>{
      const opt=document.createElement('option'); opt.value=k; opt.textContent=k; krediOpt.appendChild(opt);
    });
  } else {
    krediKeys.forEach(k=>{
      const opt=document.createElement('option'); opt.value=k; opt.textContent=k; krediOpt.appendChild(opt);
    });
  }
}

function kreditFallbacks(){ return ["K.KARTI TEK ÇEKİM","K.KARTI 2 TAKSİT","K.KARTI 5 TAKSİT"] }

function updateSenet(){
  const toplam=parseFloat(toplamEl.value)||0;
  const nakit=parseFloat(nakitEl.value)||0;
  const senet=Math.max(toplam-nakit,0);
  senetEl.value=senet.toFixed(2);
}

function renderResultsReset(){
  rToplam.textContent=tl(0);
  rNakitKdv.textContent=tl(0);
  rSenetKdv.textContent=tl(0);
  rNakitPrim.textContent=tl(0);
  rSenetPrim.textContent=tl(0);
  rKrediPrim.textContent=tl(0);
  rTopPrim.textContent=tl(0);
}

function hesapla(){
  const toplam = parseFloat(toplamEl.value) || 0;
  const nakit = parseFloat(nakitEl.value) || 0;
  const senet = Math.max(toplam - nakit, 0);
  const hesaba = parseFloat(hesabaEl.value) || 0;

  const kdvFactor = 1.20;
  const nakitKdv = nakit / kdvFactor;
  const nakitPrim = nakitKdv * 0.21;

  const krediSecili = checkKredi.checked;

  let senetPrim = 0;
  let senetKdv = 0;
  if (!krediSecili) {
    const satisKey = satisEl.value || "";
    const satisNum = parseInt(satisKey.split("+")[1]) || 0;
    const urun = urunEl.value;
    let senetOran = 0.17;
    if (urun === "TR") senetOran = (satisNum > 12) ? 0.11 : 0.17;
    else if (urun === "RO - Unique" || urun === "RO - Unique M5") senetOran = (satisNum > 7) ? 0.11 : 0.17;
    else if (urun === "RO - Platinum" || urun === "RO - Silver") senetOran = 0.11;
    else if (urun === "Klima-12" || urun === "Klima-18") senetOran = 0.09;

    senetKdv = senet / kdvFactor;
    senetPrim = senetKdv * senetOran;
  }

  const krediPrim = krediSecili ? (hesaba / kdvFactor) * 0.21 : 0;
  const toplamPrim = nakitPrim + senetPrim + krediPrim;

  rToplam.textContent = tl(toplam);
  rNakitKdv.textContent = tl(nakitKdv);
  rSenetKdv.textContent = tl(senetKdv);
  rNakitPrim.textContent = tl(nakitPrim);
  rSenetPrim.textContent = tl(senetPrim);
  rKrediPrim.textContent = tl(krediPrim);
  rTopPrim.textContent = tl(toplamPrim);
}

urunEl.addEventListener('change',()=>{updateSatisOptions();updateKrediOptions()});
satisEl.addEventListener('change',()=>{toplamEl.value = (satisMap[urunEl.value][satisEl.value]||0); updateSenet(); renderResultsReset()});
nakitEl.addEventListener('input',()=>{updateSenet(); renderResultsReset()});
btnHesapla.addEventListener('click',()=>{if(checkKredi.checked){hesabaEl.disabled=false;krediOpt.disabled=false} hesapla()});
btnTemizle.addEventListener('click',()=>{urunEl.selectedIndex=0; populateUrunler(); updateSatisOptions(); nakitEl.value=''; senetEl.value=''; hesabaEl.value=''; checkKredi.checked=false; krediOpt.disabled=true; hesabaEl.disabled=true; renderResultsReset();});
checkKredi.addEventListener('change',()=>{
  const on=checkKredi.checked;
  satisEl.disabled=on;
  nakitEl.disabled=on;
  senetEl.disabled=on;
  hesabaEl.disabled=!on;
  krediOpt.disabled=!on;
  if(on){
    const u=urunEl.value;
    const k=krediOpt.value||kreditFallbacks()[0];
    const fiyat=(satisMap[u]&&satisMap[u][k])?satisMap[u][k]:0;
    toplamEl.value=fiyat;
    nakitEl.value='0.00';
    senetEl.value='0.00';
  } else {
    const u=urunEl.value;
    const s=satisEl.value;
    if(u&&s&&satisMap[u]&&satisMap[u][s]!==undefined){toplamEl.value=satisMap[u][s]}
    hesabaEl.value='';
    nakitEl.value='';
    senetEl.value='';
  }
  renderResultsReset();
});
krediOpt.addEventListener('change',()=>{
  if(checkKredi.checked){
    const u=urunEl.value;
    const k=krediOpt.value;
    const fiyat=(satisMap[u]&&satisMap[u][k])?satisMap[u][k]:0;
    toplamEl.value=fiyat;
    nakitEl.value='0.00';
    senetEl.value='0.00';
    renderResultsReset();
  }
});

populateUrunler();
updateSatisOptions();
updateKrediOptions();
renderResultsReset();
</script>
</body>
</html>
